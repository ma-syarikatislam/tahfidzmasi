<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <script>
    let globalData = {};

    function populateDropdowns(data) {
      globalData = data;

      // Isi penguji
      fillOptions('penguji', data.penguji);
      // Isi kelas
      fillOptions('kelas', data.kelas);
      // Isi surat
      fillOptions('surat', data.surat);
      // Isi keterangan
      fillOptions('keterangan', data.keterangan);
    }

    function fillOptions(id, options) {
      const select = document.getElementById(id);
      select.innerHTML = ''; // kosongkan dulu
      options.forEach(option => {
        const el = document.createElement('option');
        el.value = el.textContent = option;
        select.appendChild(el);
      });
    }

    function updateSiswaDropdown() {
      const kelas = document.getElementById('kelas').value;
      const siswaList = globalData.siswaPerKelas[kelas] || [];
      fillOptions('siswa', siswaList);
    }

    google.script.run.withSuccessHandler(populateDropdowns).getDropdownData();
  </script>
</head>
<body>
  <h1 style="text-align:center;">Penilaian Tahfidz</h1>
  <div style="max-width:500px; margin:auto; padding:20px;">
    <label for="penguji">Nama Penguji</label>
    <select id="penguji"></select>

    <label for="kelas">Kelas</label>
    <select id="kelas" onchange="updateSiswaDropdown()"></select>

    <label for="siswa">Nama Siswa</label>
    <select id="siswa"></select>

    <label for="surat">Surat</label>
    <select id="surat"></select>

    <label for="keterangan">Keterangan</label>
    <select id="keterangan"></select>

    <label for="catatan">Catatan:</label>
    <textarea id="catatan" style="width:100%; height:100px;"></textarea>

    <button style="margin-top:15px; padding:10px; width:100%; background-color:#2ecc71; color:white; font-size:16px; border:none; border-radius:6px;">Kirim</button>
  </div>
</body>
</html>
<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <script>
    let globalData = {};

    function populateDropdowns(data) {
      globalData = data;

      // Isi penguji
      fillOptions('penguji', data.penguji);
      // Isi kelas
      fillOptions('kelas', data.kelas);
      // Isi surat
      fillOptions('surat', data.surat);
      // Isi keterangan
      fillOptions('keterangan', data.keterangan);
    }

    function fillOptions(id, options) {
      const select = document.getElementById(id);
      select.innerHTML = ''; // kosongkan dulu
      options.forEach(option => {
        const el = document.createElement('option');
        el.value = el.textContent = option;
        select.appendChild(el);
      });
    }

    function updateSiswaDropdown() {
      const kelas = document.getElementById('kelas').value;
      const siswaList = globalData.siswaPerKelas[kelas] || [];
      fillOptions('siswa', siswaList);
    }

    google.script.run.withSuccessHandler(populateDropdowns).getDropdownData();
  </script>
</head>
<body>
  <h1 style="text-align:center;">Penilaian Tahfidz</h1>
  <div style="max-width:500px; margin:auto; padding:20px;">
    <label for="penguji">Nama Penguji</label>
    <select id="penguji"></select>

    <label for="kelas">Kelas</label>
    <select id="kelas" onchange="updateSiswaDropdown()"></select>

    <label for="siswa">Nama Siswa</label>
    <select id="siswa"></select>

    <label for="surat">Surat</label>
    <select id="surat"></select>

    <label for="keterangan">Keterangan</label>
    <select id="keterangan"></select>

    <label for="catatan">Catatan:</label>
    <textarea id="catatan" style="width:100%; height:100px;"></textarea>

    <button style="margin-top:15px; padding:10px; width:100%; background-color:#2ecc71; color:white; font-size:16px; border:none; border-radius:6px;">Kirim</button>
  </div>
</body>
</html>
